{% from "../components/chart-card/macro.html"      import chartCard %}
{% from "../components/filters/views/macro.html" import appFilters %}
{% from "moj/components/page-header-actions/macro.njk" import mojPageHeaderActions %}

{% extends "./metrics-layout.html" %}

{% block dashboardBody %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h3 class="govuk-heading-l">
      {{ title }}
      <span class="govuk-caption-m">
        Last updated: {{ metric.lastUpdated }} (sampled {{ metric.updateSchedule }})
      </span>
    </h3>
  </div>
  <div class="govuk-grid-column-one-third">
    {{ appFilters('dashboard', filters, null, null, true) }}
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full insight-card-container">
    {% for metric in metrics %}
      {% if metric.type == 'headline' %}
        <div class="metric-card inight-card-group__item">
          <p class="govuk-heading-m govuk-!-margin-bottom-1">{{ metric.name }}</p>
          <p class="govuk-heading-l govuk-!-padding-top-1 govuk-!-margin-bottom-3">
            {% if metric.status %}
            <span class="insight-card-value govuk-tag govuk-tag--{{ metric.status }}">{{ metric.value }}</span>
            {% else %}
            {{ metric.value }}
            {% endif %}
          </p>
          {% if metric.breakdown %}
          <a href="{{ metric.breakdown }}">view breakdown</a>
          {% endif %}
          {% if metric.viewRecords %}
          <a href="{{ metric.viewRecords }}">view records</a>
          {% endif %}
        </div>
      {% elif metric.type == 'chartCard' %}
        <div class="metric-card inight-card-group__item insight-chart-card">
          {{ chartCard(metric.value, metric.id) }}
        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>

{% endblock %}